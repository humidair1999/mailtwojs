/*

Mailtwo.js - A better way to handle 'mailto:' links across your site

J. Ky Marsh, jkymarsh@gmail.com
Copyright (c) 2012

*/(function(e,t,n,r){var i="mailtwo",s={modalBgClass:"mailtwoBackground",modalClass:"mailtwoModal"},o=function(t,n){this.element=t;this.defaults=s;this.name=i;this.options=e.extend({},s,n);this.init()};o.prototype.constructModal=function(t){var n="."+t.modalBgClass,r="."+t.modalClass,i=function(){var n=e("<div />"),r="",i=["facebook","twitter","linkedin"],s=[t.facebook,t.twitter,t.linkedin];r+='<span>Contact Me</span><a href="#" id="closeMailtwoModal"></a><ul><li><span>Send me an email:</span><input type="text" id="mailtwoInput" placeholder="Subject" /><textarea id="mailtwoTextarea" placeholder="Message"></textarea><a href="'+t.emailFull+'&subject=&body=" id="sendMailtwoEmail" target="_blank">Send</a>'+"</li>";for(var o=0;o<i.length;o++)s[o]&&(r+='<li><a href="http://'+i[o]+".com/"+s[o]+'" target="_blank" class="mailtwo'+i[o]+'"></a>'+"</li>");r+="</ul>";n.addClass(t.modalClass).html(r);return n};e("body").children(n).length===0?e("<div />").addClass(t.modalBgClass).html(i()).appendTo("body"):e(n).html(i());e(r).css({top:"50%",left:"50%","margin-left":-(e(r).outerWidth()/2),"margin-top":-(e(r).outerHeight()/2)})};o.prototype.init=function(){var t=this,r=e(this.element),i=this.options;i.emailFull=r.attr("href");i.facebook=i.facebook||r.attr("data-facebook");i.twitter=i.twitter||r.attr("data-twitter");i.linkedin=i.linkedin||r.attr("data-linkedin");if(i.emailFull.indexOf("[at]")>-1||i.emailFull.indexOf("[dot]")>-1){i.emailFull=i.emailFull.replace("[at]","@");i.emailFull=i.emailFull.replace("[dot]",".")}r.on("click",function(n){n.preventDefault();t.constructModal(i);e("."+i.modalBgClass).show()});e(n).on("click","#closeMailtwoModal",function(t){t.preventDefault();t.stopImmediatePropagation();e(this).parent().parent().hide()});e(n).on("keyup","#mailtwoInput, #mailtwoTextarea",function(t){var n=e("#sendMailtwoEmail").attr("href"),r=n.match(/(&subject=)[^&]*/),i=n.match(/(&body=)[^&]*/);t.stopImmediatePropagation();t.currentTarget.id==="mailtwoInput"?n=n.replace(r[0],"&subject="+e("#mailtwoInput").val()):n=n.replace(i[0],"&body="+e("#mailtwoTextarea").val());n=n.replace(/\s/g,"%20");e("#sendMailtwoEmail").attr("href",n)})};e.fn[i]=function(t){var n=function(){var n=e(this).attr("href");n.indexOf("mailto:")>-1&&(e.data(this,"plugin_"+i)||e.data(this,"plugin_"+i,new o(this,t)))};return this.each(function(){e(this).attr("href")?n.call(this):e(this).find("a").each(function(){n.call(this)})})}})(jQuery,window,document);